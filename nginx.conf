# Optional nginx configuration for production\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    upstream directory_api {\n        server directory-api:3000;\n    }\n\n    server {\n        listen 80;\n        server_name localhost;\n\n        # Rate limiting\n        limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;\n\n        location / {\n            limit_req zone=api burst=20 nodelay;\n            \n            proxy_pass http://directory_api;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;\n            proxy_set_header Connection 'upgrade';\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n            proxy_cache_bypass $http_upgrade;\n            \n            # Timeouts\n            proxy_connect_timeout 60s;\n            proxy_send_timeout 60s;\n            proxy_read_timeout 60s;\n        }\n\n        # Health check endpoint (no rate limiting)\n        location /health {\n            proxy_pass http://directory_api;\n            access_log off;\n        }\n    }\n}